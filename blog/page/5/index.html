
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>DataChomp</title>
  <meta name="author" content="Rob Sullivan">

  
  <meta name="description" content="Start: Anyone who has done scripting tasks in SSIS knows how valuable being able to leverage .NET can be when you are building data solutions. Based &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://datachomp.github.com/blog/page/5">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="DataChomp" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/lib/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-1806527-13']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">DataChomp</a></h1>
  
    <h2>Chomping At The Bits</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:datachomp.github.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Home</a></li>
  <li><a href="/blog/archives/">Archives</a></li>
  <li><a href="/books">Books</a></li>
  <li><a href="/speaking">Speaking/Travel</a></li>
  <li><a href="/about">About</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/archives/getting-started-with-sql-clr-part-1/">Getting Started With SQL CLR Part 1</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-07-27T00:00:00-05:00" pubdate data-updated="true">Jul 27<span>th</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><h1></h1>

<p>Start: Anyone who has done scripting tasks in SSIS knows how valuable being able to leverage .NET can be when you are building data solutions. Based on a recent presentation, by <a href="http://www.timmitchell.net/">Tim Mitchell</a>, I was encouraged to extend .NET past SSIS and start exploring SQL CLR. Let&#8217;s get started:</p>

<p>First, we need to enable CLR on our database:</p>

<pre><code>sp_configure 'clr enabled', 1
GO
RECONFIGURE
GO
</code></pre>

<p>Next, we fire up Visual Studio and create a Database project. C# is my language of choice so I choose it:<br/>
<img src="http://images.datachomp.com/sqlserver/sqlclr/CreateProject.jpg" alt="CreateProject" /></p>

<p>After that, it will likely ask you for some DB credentials, much like creating a datasource when you are doing other .net applications. Like other .NET solutions, you can right click on your project, go to properties and change your connection on the &#8216;database&#8217; tab. Once you get your project up, right click on add a new item, and select stored procedure. Give it a name bearing in mind that the name you give it will be what the procedure gets deployed as. Once created you will see that VS takes care of a lot of the plumbing for you:</p>

<pre><code>1.  &amp;nbsp;

2.  using System;

3.  using System.Data;

4.  using System.Data.SqlClient;

5.  using System.Data.SqlTypes;

6.  using Microsoft.SqlServer.Server;

7.  &amp;nbsp;

8.  &amp;nbsp;

9.  public partial class StoredProcedures

10. &amp;#123;

11.     &amp;#91;Microsoft.SqlServer.Server.SqlProcedure&amp;#93;

12.     public static void clr_Chomp&amp;#40;&amp;#41;

13.     &amp;#123;

14.         // Put your code here

15.     &amp;#125;

16. &amp;#125;;

17. &amp;nbsp;
</code></pre>

<p>Let&#8217;s throw in some code:</p>

<pre><code>1.  &amp;nbsp;

2.      &amp;#91;Microsoft.SqlServer.Server.SqlProcedure&amp;#93;

3.      public static void clr_Chomp&amp;#40;out string Chomps&amp;#41;

4.      &amp;#123;

5.          Chomps = "Chomp Chomp Chomp Chomp";

6.      &amp;#125;

7.  &amp;nbsp;
</code></pre>

<p>What did we add? We basically declared an output parameter (out string chomps), and then said that variable is just going to return the text &#8216;Chomp&#8217; X 4.<br/>
Compile, and deploy. Gotcha - For those of us that use VS 2010 our default framework is 4.0 &#8230;. this won&#8217;t jive in SQL Server so you will get a successful build, but a failed deployment. Follow the yellow brick errors and change your target framework down to 3.5 (if deploying to SQL Server 2008). Once that is done, it is time to see this guy in action!!!<br/>
Make sure you are in the proper database and run it:</p>

<pre><code>1.  &amp;nbsp;

2.  DECLARE @words VARCHAR&amp;#40;25&amp;#41;

3.  EXEC dbo.clr_Chomp @Chomps = @words OUTPUT

4.  SELECT @words

5.  &amp;nbsp;
</code></pre>

<p>and it should spit out some Chomps for you. If it worked, go reward yourself with some M&amp;M&#8217;s. If it didn&#8217;t work for you then:</p>

<pre><code>1.  &amp;nbsp;

2.  GOTO START;

3.  &amp;nbsp;
</code></pre>

<p>In Part 2, I will begin leaving the playground of basic examples and start showing real practical implementations of SQLCLR.<br/>
In Part 3, I will likely look at performance and some other items to help round out the series.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/archives/helper-classes/">Helper Classes</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-07-20T00:00:00-05:00" pubdate data-updated="true">Jul 20<span>th</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><h1></h1>

<p>Trust me when I say I&#8217;m no stranger to abusing repeat methods in code behinds&#8230; however, it does reach a point where something has to give. When you reach that point, your solution is a &#8216;helper&#8217; class.</p>

<p>Below is a quick/basic example of how to get started with helper classes.<br/>
In my solution, I created a folder called &#8216;Helpers&#8217; and added a new class object called &#8216;StringManip&#8217;.<br/>
Once that was completed, I added a few methods like:</p>

<pre><code>1.  &amp;nbsp;

2.  public static string UpperString&amp;#40;string val&amp;#41;

3.  &amp;#123; return val.ToUpper&amp;#40;&amp;#41;; &amp;#125; 

4.  &amp;nbsp;
</code></pre>

<p>In my code behind, I reference the class through a using statement:</p>

<pre><code>1.  &amp;nbsp;

2.  using HelperClass.Helpers;

3.  &amp;nbsp;
</code></pre>

<p>And then I can call the methods:</p>

<pre><code>1.  &amp;nbsp;

2.  lbl_aspnet.Text = StringManip.UpperString&amp;#40;lbl_aspnet.Text&amp;#41;;

3.  &amp;nbsp;
</code></pre>

<p>If the above isn&#8217;t enough to get you rolling&#8230;. then download the demo solution by <a href="http://files.datachomp.com/AppDev/HelperClass.zip">Clicking Here</a></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/archives/change-iphone-root-password-after-jailbreak/">Change iPhone Root Password After Jailbreak</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-07-07T00:00:00-05:00" pubdate data-updated="true">Jul 7<span>th</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><h1></h1>

<p>One of the great benefits to having a jailbroken iPhone is the SSH feature. One of the great security risks of having a jailbroken iPhone is the SSH feature and the fact that the phone has the same global password for all iPhones. Luckily, there is a quick fix for this.</p>

<p>In Cydia, go to the &#8220;Search&#8221; section and find the app called <strong><em>MobileTerminal</em></strong>. Install it, then launch it.<br/>
From there, type in <strong><em>su root</em></strong> and hit return. This changes us to the root user so we can access/change the password for it. It will then prompt you to type in that global root password of <strong><em>alpine</em></strong> . Once you are root, just type <strong><em>passwd</em></strong> then hit return. From there, you will need to enter, then re-enter your password and the change should take place. Simply type in <strong><em>exit</em></strong> to leave the root account and get back to the standard prompt.</p>

<p><strong>Another Notch: Changing the Mobile User</strong><br/>
You should also consider doing the same thing for your Mobile user as it uses a global password of &#8220;alpine&#8221; as well<br/>
You start the MobileTerminal app as the Mobile user, so to change the password for it simply type <strong>*passwd</strong> Then type alpine when it prompts, then fill out the stuff for the new password and start sleeping better at night knowing that you have just put up a basic security fence for your sweet sweet jailbroken phone.
For more information, check out these handy posts:</p>

<p>and</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/archives/ssl-a-secure-way-to-waste-money/">SSL &#8211; a Secure Way to Waste Money</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-06-28T00:00:00-05:00" pubdate data-updated="true">Jun 28<span>th</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><h1></h1>

<p>It seems like every place I go, companies are dropping an incredible amount money on an overpriced Verisign certificate which essentially proves nothing. I am not going to tirade on Verisign&#8217;s prices, product, or just the general crappy nature of the company&#8230; but I will list alternatives:</p>

<p>The current ones I use and it rocks:<br/>
For http SSL I use: <a href="http://cert.startcom.org/">Start Com</a><br/>
For other services/protocols I tend to use:<br/>
<a href="http://www.cacert.org/">CA Cert Org</a></p>

<p>I don&#8217;t think cacert is any better/worse than startcom, I just mostly use cacert for internal stuff out of habit and I generally like the group.</p>

<p>Equally excellent CA&#8217;s that are not free:<br/>
<a href="http://www.dynadot.com/ssl/about.html">Dynadot.com</a><br/>
<a href="http://www.rapidssl.com/index_ssl.htm">Rapidssl.com</a><br/>
<a href="http://www.geotrust.com/">Geotrust.com</a></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/archives/databasemail-time-to-clean-house/">DatabaseMail Time to Clean House</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-06-28T00:00:00-05:00" pubdate data-updated="true">Jun 28<span>th</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><h1></h1>

<p>So hopefully you have moved to databasemail and started enjoying its many benefits. Remember that cool benefit of it logging all the emails for you and such? Well that comes at a price, and the price is an ever growing MSDB. So, you should consider setting a retention date for your servers and create or add the following to your maintenance packages/jobs.</p>

<p>This script will clear out the mail items and the log based on the @Retention_Days variable:</p>

<pre><code>1.  &amp;nbsp;

2.  DECLARE @Retention_days SMALLINT

3.      , @Delete_Date DATETIME

4.  &amp;nbsp;

5.  SET @Retention_Days = -90  -- 3 months

6.  SET @Delete_Date = DATEADD&amp;#40;d, @Retention_Days, GETDATE&amp;#40;&amp;#41;&amp;#41;

7.  &amp;nbsp;

8.  EXECUTE msdb.dbo.sysmail_delete_mailitems_sp @sent_before = @Delete_Date

9.  EXECUTE msdb.dbo.sysmail_delete_log_sp @logged_before = @Delete_Date

10. &amp;nbsp;
</code></pre>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/archives/getting-started-with-solid-state-drives/">Getting Started With Solid State Drives</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-06-26T00:00:00-05:00" pubdate data-updated="true">Jun 26<span>th</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><h1></h1>

<p>Step 1 - Make sure AHCI is working in the bios. This is used for TRIM and such.<br/>
Step 2 - Make sure the SSD is aligned. Pull up &#8220;msinfo32&#8221;, navigate to Components -> Storage -> Disks, and look for &#8220;Partition Starting Offset&#8221;. Use those numbers and <a href="http://www.techpowerup.com/articles/other/157">Techpowerup - SSD Alignment Calculator</a> to make sure your disk is aligned.</p>

<p>Step 3 - Make sure TRIM is enabled. At the command prompt, type-> &#8220;fsutil behavior query disabledeletenotify&#8221; A 0 means that TRIM is on, a 1 means it is off. To turn Trim on type, &#8220;fsutil behavior set disabledeletenotify 0&#8221; .</p>

<p>Step 4 - Use programs like Filemon and such to see if you have something that is doing heavy writes on your SSD. Depending on what they are, you might want to move them to something else.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/archives/ssis-and-the-embedded-delimiter-fail/">SSIS and the Embedded Delimiter Fail</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-05-31T00:00:00-05:00" pubdate data-updated="true">May 31<span>st</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><h1></h1>

<p>Simple CSV file with some embedded delimiters. No big deal in SQL 2000 DTS right? Well, it&#8217;s a huge deal in SQL Server 2005 and SQL Server 2005 SSIS. Of course, it is a bit of a mystery while they keep removing functionality but that isn&#8217;t the point of this post. The point of this post is to show a solution&#8230;</p>

<p>The solution comes by way of the Microsoft SQL Server Community Samples: Integration Services (yes, it is a long name for &#8216;Look dudes! We are giving you a work around!&#8217; but it works non the less).</p>

<p>http://sqlsrvintegrationsrv.codeplex.com/</p>

<p>I tried the delimited file reader in a variety of scenarios and it passed with flying colors. How nice it is to be able do the same imports that were effortless in SQL 2000.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/archives/how-to-test-email-with-port-25-blocked/">How to Test Email With Port 25 Blocked</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-02-21T00:00:00-06:00" pubdate data-updated="true">Feb 21<span>st</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><h1></h1>

<p>Recently, I got rid of the business line to my house. The downside to this is losing ports 25 and 80. Port 80 isn&#8217;t a real deal breaker as when I&#8217;m coding/debugging I&#8217;m just using a local webserver. However, when I am testing email functionality in an application things get a little more interesting. The fix I found for this involves how you specify the SMTP actions in the webconfig.</p>

<p>In your  section, you can specify either network delivery or a pickup location:<br/>
`</p>

<p>`<br/>
At this point you just check the local directory for email when you are testing your application. If you don&#8217;t have system for production deployments, then don&#8217;t forget to change to the network delivery when you deploy.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/archives/sql-server-20052008-alert-pack/">SQL Server 2005/2008 Alert Pack</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-02-18T00:00:00-06:00" pubdate data-updated="true">Feb 18<span>th</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><h1></h1>

<p>Outside of the daily WTF&#8217;s I create&#8230; one of the larger WTF&#8217;s I know is the SQL Server team removing the built in alerts in SQL Server 2005 and SQL Server 2008. Naturally I am going to gloss over a lot of this and just link up the code. To go more in depth on this, read the &#8216;related link&#8217; at the bottom.</p>

<p>Lets walk through the file- (Make sure you have DatabaseMail set up and set the Agent to use DatabaseMail)</p>

<ol>
<li>In the @email list variable&#8230; set the notification emails you want</li>
<li>Notice the &#8216;use MSDB&#8217; - that is SQL Agent&#8217;s crib</li>
<li>You are then going to see the create statements for a variety of alerts in the agent</li>
<li><p>the SQL 2000 alerts have some different delay intervals that throw warnings in 05/08. my script fixes that</p></li>
<li><p>Create an operator named &#8216;DBA&#8217; and assign it the desired emails.</p></li>
<li>Add the DBA operator to the alerts and tell it to use email notification</li>
</ol>


<p>Here is the file:</p>

<p>Related Link:<br/>
<a href="http://www.karaszi.com/SQLServer/util_agent_alerts.asp">http://www.karaszi.com/SQLServer/util_agent_alerts.asp</a></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/archives/with-fruit-rollup/">With Fruit Rollup</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-02-13T00:00:00-06:00" pubdate data-updated="true">Feb 13<span>th</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><h1></h1>

<p>Anyone who has to do reporting on a recurring basis knows what a pain it can be when you have to provide columns totals for the app. Treatment for this pain can be found with the ROLLUP command.<br/>
Run this example to see what I mean:</p>

<p>CREATE TABLE #temper (row_id INT IDENTITY(1,1)<br/>
   , Account_Name VARCHAR(50), balance smallmoney);<br/>
INSERT INTO #temper <br/>
VALUES (&#8216;Jimmy Johns&#8217;, 50),(&#8216;Qdoba&#8217;,60)<br/>
   ,(&#8216;Big Truck Tacos&#8217;, 70),(&#8216;Hideaway&#8217;, 80),(&#8216;Teds&#8217;, 90);<br/>
SELECT Account_Name, SUM(balance) AS BALANCE<br/>
FROM #temper<br/>
GROUP BY Account_Name WITH ROLLUP;<br/>
DROP TABLE #temper;</p>

<p>Pretty cool right?  The downside being that there is a NULL to deal with and that isn&#8217;t a very descript name for the total.  So maybe we plaster on a CASE statement to replace the NULL with something a little digestible to a user:</p>

<p>CREATE TABLE #temper (row_id INT IDENTITY(1,1)<br/>
   , Account_Name VARCHAR(50), balance smallmoney);<br/>
INSERT INTO #temper <br/>
VALUES (&#8216;Jimmy Johns&#8217;, 50),(&#8216;Qdoba&#8217;,60)<br/>
   ,(&#8216;Big Truck Tacos&#8217;, 70),(&#8216;Hideaway&#8217;, 80),(&#8216;Teds&#8217;, 90);<br/>
SELECT CASE<br/>
   WHEN (Grouping(Account_Name)=1) THEN &#8217;Total&#8217;<br/>
   ELSE Account_Name<br/>
   END AS Account_Name<br/>
   , SUM(balance) AS BALANCE<br/>
FROM #temper<br/>
GROUP BY Account_Name WITH ROLLUP;<br/>
DROP TABLE #temper;</p>

<p>For more a more wordy version of this, consult the 4 Guys:</p>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/blog/page/6/">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/blog/page/4/">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
	<a href="/"><img src="http://static.datachomp.com/datachomp.png" width="236" height="236" alt="Data Eating Alligator" /></a><br/>
	<a href="http://tekpub.com/productions/pg"><img src="http://static.datachomp.com/pg_thumb.png" alt="Tekpub" width=120 height=80 /></a>
	<br/>
	<a href="http://tekpub.com/productions/ft_sullivan"><img src="http://static.datachomp.com/ft_sullivan_thumb.png" alt="Tekpub" /></a>
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/archives/top-10-reasons-i-like-postgres-over-sql-server/">Top 10 Reasons I like Postgres Over SQL Server</a>
      </li>
    
      <li class="post">
        <a href="/archives/so-long-and-thanks-for-all-the-deadlocks/">So Long and Thanks For All The Deadlocks</a>
      </li>
    
      <li class="post">
        <a href="/archives/later-wordpress/">Later Wordpress</a>
      </li>
    
      <li class="post">
        <a href="/archives/stopping-spam-in-contact-form-7/">Stopping spam in Contact Form 7</a>
      </li>
    
      <li class="post">
        <a href="/archives/running-the-right-rubies-on-heroku/">Running the right rubies on Heroku</a>
      </li>
    
  </ul>
</section>





  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2013 - Rob Sullivan -
  <span class="credit">Served by <a href="http://octopress.org">Octopress</a> and Github</span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'datachomp';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
