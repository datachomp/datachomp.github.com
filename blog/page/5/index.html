
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>DataChomp</title>
  <meta name="author" content="Rob Sullivan">

  
  <meta name="description" content="Thanks to everyone who came to the OKCSQL  last night and endured my presentation.  We covered a lot of cool stuff and since I didn&rsquo;t have any &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://datachomp.github.com/blog/page/5">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="DataChomp" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/lib/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-1806527-13']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">DataChomp</a></h1>
  
    <h2>Chomping At The Bits</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:datachomp.github.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Home</a></li>
  <li><a href="/blog/archives/">Archives</a></li>
  <li><a href="/books">Books</a></li>
  <li><a href="/speaking">Speaking/Travel</a></li>
  <li><a href="/about">About</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/archives/sql-server-variety-hour/">SQL Server Variety Hour</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-12-14T00:00:00-06:00" pubdate data-updated="true">Dec 14<span>th</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><h1></h1>

<p>Thanks to everyone who came to the OKCSQL  last night and endured my presentation.  We covered a lot of cool stuff and since I didn&rsquo;t have any links in my slides, I figured I would link up the stuff we talked about:</p>

<p>WhoIsActive &ndash; <a href="http://sqlblog.com/blogs/adam_machanic/archive/2010/10/21/who-is-active-v10-00-dmv-monitoring-made-easy.aspx" title="http://sqlblog.com/blogs/adam_machanic/archive/2010/10/21/who-is-active-v10-00-dmv-monitoring-made-easy.aspx">http://sqlblog.com/blogs/adam_machanic/archive/2010/10/21/who-is-active-v10-00-dmv-monitoring-made-easy.aspx</a></p>

<p>SQLioSim- <a href="http://support.microsoft.com/kb/231619" title="http://support.microsoft.com/kb/231619">http://support.microsoft.com/kb/231619</a></p>

<p>SQL SourceControl- <a href="http://www.red-gate.com/products/sql-development/sql-source-control/" title="http://www.red-gate.com/products/sql-development/sql-source-control/">http://www.red-gate.com/products/sql-development/sql-source-control/</a></p>

<p>.Net Reflector- <a href="http://www.red-gate.com/products/dotnet-development/reflector/" title="http://www.red-gate.com/products/dotnet-development/reflector/">http://www.red-gate.com/products/dotnet-development/reflector/</a></p>

<p>LinqPad- <a href="http://linqpad.net/" title="http://linqpad.net/">http://linqpad.net/</a></p>

<p>EF Profiler- <a href="http://efprof.com/" title="http://efprof.com/">http://efprof.com/</a></p>

<p>RavenDB- <a href="http://ravendb.net/" title="http://ravendb.net/">http://ravendb.net/</a></p>

<p>Virtualization &ndash; <a href="http://www.vmware.com/" title="http://www.vmware.com/">http://www.vmware.com/</a></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/archives/stored-procedure-output-params-and-return-values/">Stored Procedure Output Params and Return Values</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-10-24T00:00:00-05:00" pubdate data-updated="true">Oct 24<span>th</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><h1></h1>

<p>Many times I see abuse of the Return Value in a stored procedure. What I mean by this is essentially using the Return Value to send back say an identity value or something like:
<code></p>

<pre><code>SET @TheID = SCOPE_IDENTITY();
RETURN @TheID
</code></pre>

<p></code></p>

<p>My personal thought on the matter is that you use the Return Values are for determining the execution health of the procedure you called, and that to get an ID value either from a record set or an OUTPUT parameter. This allows a separation of concerns and provides a way for an application to completely understand the intent of the procedure that executed. Lets jump to the code to see what I mean:
<code></p>

<pre><code>--drop table dbo.pizza
CREATE TABLE Pizza (pizzaid TINYINT IDENTITY(1,1), pizzasize VARCHAR(10), numberoftoppings TINYINT, pizzaname VARCHAR(40) )

CREATE PROCEDURE dbo.asp_InsertNewPizza
    (@PizzaSize VARCHAR(10),@NumberofToppings TINYINT,@pizzaName VARCHAR(40),@PizzaID TINYINT OUTPUT
AS

BEGIN TRY
INSERT INTO dbo.Pizza (pizzaSize, NumberOftoppings,pizzaname)
VALUES (@PizzaSize, @NumberofToppings, @pizzaName)

SELECT @PizzaID = SCOPE_IDENTITY();
RETURN 0;
END Try
BEGIN Catch
    RETURN -1
END Catch
GO

DECLARE @InsertedID TINYINT, @RunOK INT;
EXEC @RunOK = dbo.asp_InsertNewPizza @pizzaSize = 'Medium',@NumberOfToppings=2, @PizzaName='Medium Cheese and Sausage', @PizzaID=@InsertedID OUT
SELECT @RunOK, @InsertedID
</code></pre>

<p></code></p>

<p>So, when we run the above code, we get a 0 for the return value (@RunOK), and a 1 for the inserted ID. Had we received a -1 for the return value, we would know that something was jacked up and not to trust the value of the OUTPUT param. Of course, like many demo&rsquo;s, this is an incredibly simple demo just to show proof of concept. We could go a huge discourse about handling failures inside the procedure, application level transactions, or any number of scenarios that might result in a &ldquo;Fine, in that case don&rsquo;t do the above&rdquo; but all that does is take away from the general message of separation of concerns and being able to quickly convey what actually happened. Lets look at this slight alteration to our operation:
<code></p>

<pre><code>CREATE PROCEDURE dbo.asp_InsertNewPizza
    (@PizzaSize VARCHAR(10),@NumberofToppings TINYINT,@pizzaName VARCHAR(40),@PizzaID TINYINT OUTPUT
AS

IF EXISTS (SELECT pizzaID FROM dbo.Pizza WHERE pizzaname = @pizzaName)
BEGIN
    SET @PizzaID = NULL;
    RETURN 1;   
END
ELSE
BEGIN TRY
    INSERT INTO dbo.Pizza (pizzaSize, NumberOftoppings,pizzaname)
    VALUES (@PizzaSize, @NumberofToppings, @pizzaName)

    SELECT @PizzaID = SCOPE_IDENTITY();
    RETURN 0;
END TRY
BEGIN CATCH
    RETURN -1
END CATCH

GO
</code></pre>

<p></code></p>

<p>Without catching the Return Values&hellip; if we get a NULL for the identity, how do we know if it is from an issue with inserting the values or an issue with a pizza name already existing? If we capture the ReturnValue and see that it is >= 0 we know that it wasn&rsquo;t from an error, but that a certain business rule had been met.</p>

<p>Well this is all good and well to us the database people, but what do we do if the app devs say it is too hard to won&rsquo;t help them. Here is just a basic call in C# with ADO.NET and how it could be used:
<code></p>

<pre><code>SqlCommand databaseCMD = new SqlCommand ("asp_InsertNewPizza", pizzaConn);

databaseCMD.CommandType = CommandType.StoredProcedure;

SqlParameter PizzaSize = databaseCMD.Parameters.Add ("@pizzaSize", SqlDbType.VarChar, 10);
PizzaSize.Direction = ParameterDirection.Input;
SqlParameter NumberOfToppings = databaseCMD.Parameters.Add ("@NumberOfToppings", SqlDbType.TinyInt);
NumberOfToppings.Direction = ParameterDirection.Input;
SqlParameter PizzaName = databaseCMD.Parameters.Add ("@PizzaName", SqlDbType.VarChar, 40);
PizzaName.Direction = ParameterDirection.Input;


SqlParameter PizzaID = databaseCMD.Parameters.Add ("@PizzaID", SqlDbType.TinyInt);
PizzaID.Direction = ParameterDirection.Output ;
SqlParameter ReturnValue = databaseCMD.Parameters.Add ("RetVal", SqlDbType.Int);
RetVal.Direction = ParameterDirection.ReturnValue;

int pizzaID;
pizzaConn.Open();

pizzaID =databaseCMD.ExecuteScalar ().ToString() ;

if (ReturnValue == 0){
ResponseWrite("The Pizza was added. The pizzaID is : " + pizzaID.ToString() );
ResponseWreite("Return Value: " + RetVal.Value);
}
else if{ ReturnValue == 1) {
ResponseWrite("Sorry friend, that pizza name already exists.");
ResponseWreite("Return Value: " + RetVal.Value);
}
else { FreakOut(); }
</code></pre>

<p></code></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/archives/virtual-victory-aws-gives-out-a-year-of-usage/">Virtual Victory &#8211; AWS Gives Out a Year of Usage</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-10-23T00:00:00-05:00" pubdate data-updated="true">Oct 23<span>rd</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><h1></h1>

<p>Amazon has just done something amazing&hellip; <a href="http://aws.amazon.com/free/">Amazingness</a>&hellip; They are essentially doing a conditional year free of their services. While I am a huge fan of VMWare, what Amazon is offering is something completely unmatched by VCloud or MS Azure.  (Please see Craig&rsquo;s comment as this claim has the possibility of being debunked. Thanks Craig!)</p>

<p>So what can I do with this you might ask? Here are some ideas: (I am doing these off the top of my head so feel free to criticize them by suggesting a better ideas)</p>

<ol>
<li><p>If you have never played with Linux/Ruby or anything else, here is a good/free way to to dabble without the &lsquo;will this mess up my system&rsquo; fear. Microsoft is continuing their adoption of features from these platforms and it can only benefit you to see these ideas they are using from Ruby(gems) or Apache(modularization). The more you know, the more you grow.</p></li>
<li><p>NOSQL? What is a NOSQL? Want a simple way to learn about NOSQL? Then try out Amazon&rsquo;s simpleDB. They have various demos and such you can run and play with and start trying to see what all the hype is about. Remember fellow fearful DBA&rsquo;s, NOSQL stands for &ldquo;Not Only SQL&rdquo; not for No &ndash; SQL as in SQL Void.</p></li>
<li><p>Embrace the awesome of Amazon S3. Ever wonder why Dropbox/JungleDisk and various other companies can give you so much storage for so cheap? Amazon S3 is pretty much the answer to that question. I typically use the cheapest hosting plans possible and S3 as a CDN to smoke/mirror performance.</p></li>
<li><p>SQL Server testing &ndash; Microsoft provides trial software for pretty much all their projects. If you are curious about &hellip; say playing with some feature of replication or maybe wondering about online indexing &hellip; Fire up 1 or more instances of EC2 and actually try it. You no longer have an excuse to put it off.</p></li>
<li><p>.Net testing or running a service &ndash; With shared hosting, I don&rsquo;t have a way of keeping an ongoing on demand service per say&hellip; So why not have a micro instance where you can deploy services and such. For example, say you need to add SMS services to your app&hellip;. Sign up for <a href="http://www.twilio.com/">Twilio</a>, create a little service, throw it on your free AWS EC2 instance and poll every hour or so. Most shared hosting sites don&rsquo;t really support SQL Server SSIS&hellip; so why not have an AWS EC2 instance that fires up at night and starts some SSIS packages?</p></li>
</ol>


<p>Now, some of this isn&rsquo;t without a learning curve, but we are in the software development industry&hellip; if we can&rsquo;t navigate learning curves or don&rsquo;t even pursue learning to begin with we add more nails to our career coffin as well as start becoming the problem.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/archives/lets-open-some-new-doors-mvc/">Lets Open Some New Doors &#8211; MVC</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-09-28T00:00:00-05:00" pubdate data-updated="true">Sep 28<span>th</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><h1></h1>

<p>I have tried ASP.NET MVC a couple times and after a couple hours seem to always roll back to webforms because it is &ldquo;easier&rdquo; or a time constraint or any number of excuses. However, last night I decided to change all that and really give MVC a fair chance. The more I tinker around in Ruby and iphone development the more I buy into the validity of the MVC approach. Here is a bit of the technology roadmap I want to drive down:</p>

<p><a href="http://mvccontrib.codeplex.com/wikipage?title=T4MVC">T4</a> &ndash; I hear about it, time to see what the fuss is about. Besides, <a href="http://twitter.com/davidebbo">David Ebbo</a> is the man.</p>

<p><a href="http://code.google.com/p/elmah/">Elmah</a> will be a proof of concept before I roll into <a href="http://www.exceptioneer.com/public/WhatIsExceptioneer.aspx">Exceptioneer</a>.</p>

<p><a href="https://aws.amazon.com/s3/">S3</a> &ndash; I have already started playing around with this and love it. It will likely be serving the images and public files.</p>

<p>Routing &ndash; a vanity name like implementation for users will be my head first dive into routing.</p>

<p>Model &ndash; As a DBA, the data layer and ADO are my bread and butter. But it is time to step forward and see what the fuss is about. I will likely be trying out EF and <a href="http://subsonicproject.com/">Subsonic</a>.</p>

<p>Charting &ndash; I&rsquo;m a stat nerd, so I will be capturing stats, I hope to be able to throw some of them into the charting control.</p>

<p>NoSQL &ndash; I&rsquo;m not sure how to work it in yet, but at some point, I am planning on having a <a href="http://aws.amazon.com/simpledb/">SimpleDB</a>/<a href="http://ravendb.net/">RavenDB</a>/<a href="http://www.mongodb.org/">MongoDB</a> section just to explore and have knowledge outside of a half dozen tech articles.</p>

<p>Lastly, it is time to branch away from Web services and start playing around with WCF. This will really come into play for the iphone app being done in <a href="http://monotouch.net/">MonoTouch</a> which really is an exciting piece of work.</p>

<p>Once we are done with ASP.NET MVC, I plan to move to Ruby 3 and try and to build the same apps in that. Should be a great compare and contrast.</p>

<p>So that is it for now, time to see if I can stick to it and see this through&hellip; or give up and step back into web forms.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/archives/early-mvc-pitfalls-shared-hosting-and-action-link/">Early MVC Pitfalls &#8211; Shared Hosting and Action Link</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-09-28T00:00:00-05:00" pubdate data-updated="true">Sep 28<span>th</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><h1></h1>

<p>I have a great hosting provider &ndash; <a href="http://www.arvixe.com/">Arvixe</a> and they are on the ball for both my Linux hosting as well as my .NET stuff. So as I started cranking out apps and went to deploy I knew I could count on them to handle the hosting task at hand. So, compile&hellip; deploy&hellip; and we&rsquo;re erroring out. Oh! I forgot to set my site to integrated pipeline&hellip;. fix that, drop some control f5 and still an issue. So, CustomErrors=OFF, deploy and see that it is an error with the System.Web.MVC assembly. That&rsquo;s odd, well a google searching showed that this is a bit of known error. To fix, you simply click on the properties of that assembly, and set the &ldquo;copy local&rdquo; property to true. More information can be found here:<br/>
<a href="http://www.britishdeveloper.co.uk/2010/05/mvc2-deploy-could-not-load-file-or.html">This dudes blog</a><br/>
and from Haacked himself: <a href="http://haacked.com/archive/2008/11/03/bin-deploy-aspnetmvc.aspx">clickey</a></p>

<p>MVC ActionLink returns ?Length= &ndash; This was a real WTF for me. Turns out that if you specify a htmlattributes overload for ActionLink and don&rsquo;t put in something like null for the route values overload, it will append some stupid length=# string to your href.</p>

<p><code></p>

<pre><code>&lt;%: Html.ActionLink("Home", "Index", "Home", new { @class = "active" })%&gt;
</code></pre>

<p></code></p>

<p>Generates the following html:
<code></p>

<pre><code>&lt;a class="active" href="/?Length=4"&gt;Home&lt;/a&gt;
</code></pre>

<p></code></p>

<p>So we throw in null for the routeValues overload:
<code></p>

<pre><code>&lt;%: Html.ActionLink("Home", "Index", "Home", null ,new { @class = "active" })%&gt;
</code></pre>

<p></code></p>

<p>and we get the html we want.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/archives/upload-file-to-s3-with-asp-net/">Upload File to S3 With ASP.NET</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-09-21T00:00:00-05:00" pubdate data-updated="true">Sep 21<span>st</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><h1></h1>

<p>I suppose the subject pulls no punches with what we&rsquo;re going to do. We are going to have simple form with a file upload and a button. Once we hit the button, whatever file was selected is going to ride the magic internet carpet and appear in an Amazon S3 bucket.<br/>
WebForm:</p>

<pre><code>1.  &amp;nbsp;

2.  

3.  
</code></pre>

<p>Code behind:</p>

<pre><code>1.  &amp;nbsp;

2.  protected void Button1_Click&amp;#40;object sender, EventArgs e&amp;#41;

3.          &amp;#123;

4.              string result = Program.GetServiceOutput&amp;#40;&amp;#41;;

5.              Label1.Text = result;

6.          &amp;#125;

7.  &amp;nbsp;
</code></pre>

<p>Class file for AWSCalls;</p>

<pre><code>1.  &amp;nbsp;

2.  using Amazon;   // these are part of the AWSSDK.dll that you add to the project

3.  using Amazon.S3;

4.  using Amazon.S3.Model;

5.  ....

6.  public static void SendFileToS3&amp;#40;string filename, Stream ImgStream&amp;#41;

7.          &amp;#123;

8.              string accessKey = "Access Key here!";

9.              string secretAccessKey = "Secret Key goes here!";

10.             string bucketName = "Bucket Name goes Here!";

11.             string keyName = filename; 

12. &amp;nbsp;

13.             AmazonS3 client = Amazon.AWSClientFactory.CreateAmazonS3Client&amp;#40;accessKey, secretAccessKey&amp;#41;;

14.             PutObjectRequest request = [new][1] PutObjectRequest&amp;#40;&amp;#41;;

15. &amp;nbsp;

16.             request.WithInputStream&amp;#40;ImgStream&amp;#41;;

17. &amp;nbsp;

18.             request.WithBucketName&amp;#40;bucketName&amp;#41;;

19.             request.WithKey&amp;#40;keyName&amp;#41;;

20.             request.StorageClass = S3StorageClass.ReducedRedundancy; //set storage to reduced redundancy

21.             client.PutObject&amp;#40;request&amp;#41;;

22.         &amp;#125;
</code></pre>

<p>So there you have it! We take a file, throw it into a page&hellip;. and that page does a heave-ho to Amazon S3. It also goes the extra step to set it to ReducedRedundancy to save you a pretty penny.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/archives/installing-mongodb-on-ubuntu/">Installing MongoDB on Ubuntu</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-09-04T00:00:00-05:00" pubdate data-updated="true">Sep 4<span>th</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><h1></h1>

<p>First step to getting started with toying around with NoSQL is getting it running. Currently, MongoDB is my choice in the land of learning. To get it going on my VM&rsquo;s I do the following after my Ubuntu server is installed.</p>

<p>Navigate to: /etc/apt/sources.list<br/>
Then: sudo pico sources.list<br/>
In your sources, add the following line: deb <a href="http://downloads.mongodb.org/distros/ubuntu">http://downloads.mongodb.org/distros/ubuntu</a> 10.4 10gen<br/>
Save/exit the file, then add the key: sudo apt-key adv &mdash;keyserver keyserver.ubuntu.com &mdash;recv 7F0CEB10</p>

<p>Once that is done, you&rsquo;re ready to update and install.<br/>
Update: sudo apt-get update<br/>
Install: sudo apt-get install mongodb-stable</p>

<p>Well now what?<br/>
If you need to configure MongoDB further, then navigate to: /etc/mongodb.conf<br/>
If you need to add/remove/mess with the database, it lives in: /var/lib/mongodb<br/>
Want the logs? They are here: /var/log/mongodb/ (.log extension)</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/archives/jquery-cdn-failover/">JQuery CDN Failover</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-08-31T00:00:00-05:00" pubdate data-updated="true">Aug 31<span>st</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><h1></h1>

<p>With &lsquo;high availability&rsquo; being a nicely stressed buzzword coupled with issues in the &lsquo;cloud&rsquo;, an issue can arise of what to do about your jquery references in the event that where you are hosting it is down? I won&rsquo;t dig into the reasons for using a CDN for jquery but will plug the usual &ndash; It will typically be cached by the time your site is hit if you use Google or Microsoft CDN as well as will likely be faster to load in general as a browser will thread out to load it (as opposed to if it is hosted under the current domain). I also have some links at the bottom for further reading on it. So, on to the failover&hellip;. and it is quite easy really since 1.4 :
<code></p>

<pre><code>&lt;script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.4/jquery.min.js"&gt;&lt;/script&gt;
&lt;script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.4/jquery-ui.js"&gt;&lt;/script&gt;

&lt;script type="text/javascript"&gt;
  if (typeof jQuery == 'undefined')
  {
     document.write(unescape("%3Cscript src='http://ajax.microsoft.com/ajax/jquery/jquery-1.4.4.min.js' type='text/javascript'%3E%3C/script%3E"));
     document.write(unescape("%3Cscript src='http://ajax.microsoft.com/ajax/jquery/jqueryui-1.8.4.min.js' type='text/javascript'%3E%3C/script%3E"));
  }
  &lt;/script&gt;
</code></pre>

<p></code></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/archives/getting-started-with-sql-clr-part-2/">Getting Started With SQL CLR Part 2</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-08-31T00:00:00-05:00" pubdate data-updated="true">Aug 31<span>st</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><h1></h1>

<p>As you start playing with SQL CLR, you learn pretty quick that the built in namespaces can be a little handicapping. You can skip this by creating an &lsquo;unsafe&rsquo; assembly in your database. In the following demo, we&rsquo;re going to load a 3rd party .library for XMPP messaging into our SQL Server instance, and use a stored procedure to send XMPP messages.</p>

<p>The XMPP library I&rsquo;ll be using is <a href="http://www.ag-software.de/agsxmpp-sdk.html">agsXMPP</a>. As you&rsquo;ll see in my code below, I tend to just use a common shared library folder so I can house various libraries and it makes it easier from an organizational standpoint to cram them into the database. I use the following code to &lsquo;cram&rsquo; the library into my instance so I&rsquo;ll be able to use it in a CLR procedure:</p>

<p><code></p>

<pre><code>CREATE ASSEMBLY [agsXMPP]
FROM 'C:SubversionShared LibsagsxmppagsXMPP.dll'
WITH PERMISSION_SET = UNSAFE
GO
</code></pre>

<p></code></p>

<p>Once that is out of the way, we can roll our CLR proc, deploy and message to our hearts content (or until the network drops)
<code></p>

<pre><code>using System;
using System.Data;
using System.Data.SqlClient;
using System.Data.SqlTypes;
using Microsoft.SqlServer.Server;

using agsXMPP;
using agsXMPP.protocol.client;
// yes,  domains and names have been changed to protect the innocent servers.
public partial class StoredProcedures
{
    [Microsoft.SqlServer.Server.SqlProcedure]
    public static void clr_SendXMPP()
    {
        XmppClientConnection xmpp;
        xmpp = new XmppClientConnection();
        xmpp.AutoPresence = true;

        xmpp.AutoResolveConnectServer = true;
        xmpp.Port = 5222;
        xmpp.UseSSL = false;
        xmpp.Server = "xmpp.datachomp.com";
        xmpp.Username = "SQLAlert";
        xmpp.Password = "SqlClr";

        xmpp.Open();

        xmpp.OnLogin += delegate(object o) { xmpp.Send(new Message(new Jid("Gatir@xmpp.datachomp.com"), MessageType.chat, "This really should be a variable yes?")); };
    }
};
</code></pre>

<p></code></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/archives/getting-started-with-sql-clr-part-1/">Getting Started With SQL CLR Part 1</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-07-27T00:00:00-05:00" pubdate data-updated="true">Jul 27<span>th</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><h1></h1>

<p>Start: Anyone who has done scripting tasks in SSIS knows how valuable being able to leverage .NET can be when you are building data solutions. Based on a recent presentation, by <a href="http://www.timmitchell.net/">Tim Mitchell</a>, I was encouraged to extend .NET past SSIS and start exploring SQL CLR. Let&rsquo;s get started:</p>

<p>First, we need to enable CLR on our database:</p>

<pre><code>sp_configure 'clr enabled', 1
GO
RECONFIGURE
GO
</code></pre>

<p>Next, we fire up Visual Studio and create a Database project. C# is my language of choice so I choose it:<br/>
<img src="http://images.datachomp.com/sqlserver/sqlclr/CreateProject.jpg" alt="CreateProject" /></p>

<p>After that, it will likely ask you for some DB credentials, much like creating a datasource when you are doing other .net applications. Like other .NET solutions, you can right click on your project, go to properties and change your connection on the &lsquo;database&rsquo; tab. Once you get your project up, right click on add a new item, and select stored procedure. Give it a name bearing in mind that the name you give it will be what the procedure gets deployed as. Once created you will see that VS takes care of a lot of the plumbing for you:
<code></p>

<pre><code>using System;
using System.Data;
using System.Data.SqlClient;
using System.Data.SqlTypes;
using Microsoft.SqlServer.Server;


public partial class StoredProcedures
{
    [Microsoft.SqlServer.Server.SqlProcedure]
    public static void clr_Chomp()
    {
        // Put your code here
    }
};
</code></pre>

<p></code></p>

<p>Let&rsquo;s throw in some code:
<code></p>

<pre><code>[Microsoft.SqlServer.Server.SqlProcedure]
    public static void clr_Chomp(out string Chomps)
    {
        Chomps = "Chomp Chomp Chomp Chomp";
    }
</code></pre>

<p></code></p>

<p>What did we add? We basically declared an output parameter (out string chomps), and then said that variable is just going to return the text &lsquo;Chomp&rsquo; X 4.<br/>
Compile, and deploy. Gotcha &ndash; For those of us that use VS 2010 our default framework is 4.0 &hellip;. this won&rsquo;t jive in SQL Server so you will get a successful build, but a failed deployment. Follow the yellow brick errors and change your target framework down to 3.5 (if deploying to SQL Server 2008). Once that is done, it is time to see this guy in action!!!<br/>
Make sure you are in the proper database and run it:
<code></p>

<pre><code>DECLARE @words VARCHAR(25)
EXEC dbo.clr_Chomp @Chomps = @words OUTPUT
SELECT @words
</code></pre>

<p></code></p>

<p>and it should spit out some Chomps for you. If it worked, go reward yourself with some M&amp;M&rsquo;s. If it didn&rsquo;t work for you then:
<code></p>

<pre><code>GOTO START;
</code></pre>

<p></code>
In Part 2, I will begin leaving the playground of basic examples and start showing real practical implementations of SQLCLR.<br/>
In Part 3, I will likely look at performance and some other items to help round out the series.</p>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/blog/page/6/">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/blog/page/4/">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
	<a href="/"><img src="http://static.datachomp.com/datachomp.png" width="236" height="236" alt="Data Eating Alligator" /></a><br/>
	<a href="http://tekpub.com/collections/everything/products/pg"><img src="http://static.datachomp.com/pg_thumb.png" alt="Tekpub" width=120 height=80 /></a>
	<br/>
	<a href="http://tekpub.com/collections/everything/products/ft_sullivan"><img src="http://static.datachomp.com/ft_sullivan_thumb.png" alt="Tekpub" /></a>	
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/archives/application-name-in-sequel/">Application_name in Sequel</a>
      </li>
    
      <li class="post">
        <a href="/archives/postgres-dot-app-and-shared-preload-libraries/">Postgres.app and Shared_preload_libraries</a>
      </li>
    
      <li class="post">
        <a href="/archives/nginx-block-php-requests/">Nginx Block Php Requests</a>
      </li>
    
      <li class="post">
        <a href="/archives/extending-sequel-with-hstore/">Extending Sequel With Hstore</a>
      </li>
    
      <li class="post">
        <a href="/archives/phusion-passenger-is-no-longer-in-opt-ion/">Passenger: No Longer in /opt/ion</a>
      </li>
    
  </ul>
</section>





  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2013 - Rob Sullivan - Hand-crafted in OK <img src="http://static.datachomp.com/ok.gif" height="15" width="15" /> - 
  <span class="credit">Served by <a href="http://octopress.org">Octopress</a> and Github</span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'datachomp';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
